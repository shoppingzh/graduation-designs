C51 COMPILER V9.01   MAIN                                                                  05/05/2018 17:27:00 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN ..\Outputs\main.obj
COMPILER INVOKED BY: D:\Dev\Keil\C51\BIN\C51.EXE ..\User\main.c BROWSE INCDIR(..\User,..\Hardware) DEBUG OBJECTEXTEND PR
                    -INT(.\main.lst) OBJECT(..\Outputs\main.obj)

line level    source

   1          #include "reg51.h"
   2          #include "lcd1602.h"
   3          #include "adc.h"
   4          #include "intrins.h"
   5          #include "stdio.h"
   6          
   7          #define uchar unsigned char
   8          #define uint unsigned int
   9          
  10          char idx = 0;
  11          code uchar cs[] = {0xfc, 0xf9, 0xf3, 0xf6};
  12          
  13          //转动
  14          void roll(){
  15   1              if(idx >= 4){
  16   2                      idx = 0;
  17   2              }
  18   1              P2 = cs[idx++];
  19   1      }
  20          
  21          //延时1
  22          void delay100ms(void) {
  23   1          uchar a,b,c;
  24   1          for(c=19;c>0;c--)
  25   1              for(b=20;b>0;b--)
  26   1                  for(a=130;a>0;a--);
  27   1      }
  28          
  29          //延时2
  30          void delay1s(void){
  31   1          uchar a,b,c;
  32   1          for(c=167;c>0;c--)
  33   1              for(b=171;b>0;b--)
  34   1                  for(a=16;a>0;a--);
  35   1          _nop_(); 
  36   1      }
  37          
  38          
  39          void main(){
  40   1              int i;
  41   1              lcd_simple_init();
  42   1      
  43   1              while(1){
  44   2      
  45   2                      char t;
  46   2                      uchar weight;
  47   2                      char str[5];
  48   2      
  49   2                      /*****************运送奶粉罐*****************/
  50   2                      lcd_display_string(1, 1, "1. Delivery pot");
  51   2                      lcd_display_string(2, 1, "time: 0s");
  52   2                      //输送奶粉罐的电机运行3s
  53   2                      for(i=0;i<31;i++){
  54   3                              //显示运行时间
C51 COMPILER V9.01   MAIN                                                                  05/05/2018 17:27:00 PAGE 2   

  55   3                              if((i != 0) && ((t = i % 10) == 0)){
  56   4                                      lcd_display_string(2, 1, "time: ");
  57   4                                      lcd_display_char(2, 7, (i/10)+48);
  58   4                                      lcd_display_char(2, 8, 's');
  59   4                              }
  60   3              
  61   3                              //转动电机
  62   3                              roll();
  63   3                              delay100ms();
  64   3                      }
  65   2              
  66   2                      //奶粉罐到位
  67   2                      delay1s();
  68   2                      lcd_clear();
  69   2                      lcd_display_string(2, 1, "--Delivery End--");
  70   2              
  71   2                      /*****************输送奶粉*****************/
  72   2                      delay1s();
  73   2                      lcd_clear();
  74   2                      lcd_display_string(1, 1, "2. Putting milk");
  75   2                      while(1){
  76   3                              roll();
  77   3                              weight = adc_transform();
  78   3                              lcd_display_string(2, 1, "weight: ");
  79   3                              sprintf(str, "%d", (int)weight);
  80   3                              lcd_display_string(2, 9, str);
  81   3              
  82   3                              //重量达标
  83   3                              if(weight == 127){
  84   4                                      lcd_clear();
  85   4                                      lcd_display_string(2, 1, "--Putting End--");
  86   4                                      break;                          
  87   4                              }
  88   3                      }
  89   2              
  90   2                      /*****************奶粉罐包装*****************/
  91   2                      delay1s();
  92   2                      lcd_clear();
  93   2                      lcd_display_string(1, 1, "3. Packing pot");
  94   2                      for(i=0;i<20;i++){
  95   3                              roll();
  96   3                              delay100ms();
  97   3                      }
  98   2                      lcd_clear();
  99   2                      lcd_display_string(2, 1, "--Packing End--");
 100   2      
 101   2                      delay1s();
 102   2                      lcd_clear();
 103   2                      lcd_display_string(2, 1, "-----All End----");
 104   2              
 105   2              
 106   2                      //暂停3s循环执行
 107   2                      delay1s();
 108   2                      delay1s();
 109   2                      delay1s();
 110   2                      lcd_clear();            
 111   2              }
 112   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    406    ----
C51 COMPILER V9.01   MAIN                                                                  05/05/2018 17:27:00 PAGE 3   

   CONSTANT SIZE    =    145    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      1       9
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
